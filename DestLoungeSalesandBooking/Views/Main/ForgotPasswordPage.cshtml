@{
    Layout = "~/Views/Shared/_MainLayout.cshtml";
}
<header>
    <div class="header-container">
        <div class="logo">
            <a href="@Url.Action("Homepage","Main")">
                <img src="~/Content/Pictures/DestLogo.png" class="logo" alt="D'est Lounge">
            </a>
        </div>
        <nav class="main-nav">
            <a href="@Url.Action("Homepage","Main")">HOME</a>
            <a href="@Url.Action("ServicePage","Main")">SERVICES</a>
            <a href="@Url.Action("ContactPage","Main")">CONTACT</a>
            <a href="@Url.Action("FAQsPage","Main")">FAQs</a>
        </nav>
        <div class="header-actions">
            <a href="@Url.Action("LoginPage","Main")" class="login-link">
                <i class="fa-regular fa-user"></i> LOGIN/SIGNUP
            </a>
            <a href="@Url.Action("ContactPage","Main")" class="email-icon">
                <i class="fa-solid fa-envelope"></i>
            </a>
        </div>
    </div>
</header>

<div class="login-container" ng-controller="DestLoungeSalesandBookingController">
    <div class="login-box">
        <h1 class="login-title">Reset Password</h1>
        <p class="forgot-password-text">
            Enter your email and current password to reset your password.
        </p>

        <!-- Display success/error messages -->
        @if (TempData["SuccessMessage"] != null)
        {
            <div class="alert alert-success">
                @TempData["SuccessMessage"]
            </div>
        }
        @if (TempData["ErrorMessage"] != null)
        {
            <div class="alert alert-error">
                @TempData["ErrorMessage"]
            </div>
        }

        <form name="resetPasswordForm"
              method="post"
              action="@Url.Action("ResetPassword","Account")"
              novalidate>

            @Html.AntiForgeryToken()

            <!-- EMAIL -->
            <div class="form-group">
                <input type="email"
                       name="email"
                       id="email"
                       class="form-input"
                       placeholder="Email"
                       ng-model="resetPassword.email"
                       ng-keydown="focusNext($event, 'currentPassword')"
                       required>
                <span class="error-message"
                      ng-show="resetPasswordForm.email.$invalid && resetPasswordForm.email.$dirty">
                    Please enter a valid email address
                </span>
            </div>

            <!-- CURRENT PASSWORD -->
            <div class="form-group password-group">
                <input type="{{ showPassword ? 'text' : 'password' }}"
                       name="currentPassword"
                       id="currentPassword"
                       class="form-input"
                       placeholder="Current Password"
                       ng-model="resetPassword.currentPassword"
                       ng-keydown="focusNext($event, 'newPassword')"
                       required>
                <i class="fa-solid toggle-password"
                   ng-class="showPassword ? 'fa-eye-slash' : 'fa-eye'"
                   ng-click="togglePassword()"></i>
            </div>

            <!-- NEW PASSWORD -->
            <div class="form-group password-group">
                <input type="{{ showPassword ? 'text' : 'password' }}"
                       name="newPassword"
                       id="newPassword"
                       class="form-input"
                       placeholder="New Password"
                       ng-model="resetPassword.newPassword"
                       ng-pattern='/@Html.Raw("^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&#])[A-Za-z\\d@$!%*?&#]{8,}$")/'
                       ng-keydown="focusNext($event, 'confirmPassword')"
                       required>
                <i class="fa-solid toggle-password"
                   ng-class="showPassword ? 'fa-eye-slash' : 'fa-eye'"
                   ng-click="togglePassword()"></i>
                <span class="error-message"
                      ng-show="resetPasswordForm.newPassword.$error.pattern && resetPasswordForm.newPassword.$dirty">
                    Password must be 8+ chars with uppercase, lowercase, number, and symbol (@@$!%*?&#)
                </span>
            </div>

            <!-- CONFIRM NEW PASSWORD -->
            <div class="form-group password-group">
                <input type="{{ showPassword ? 'text' : 'password' }}"
                       name="confirmPassword"
                       id="confirmPassword"
                       class="form-input"
                       placeholder="Confirm New Password"
                       ng-model="resetPassword.confirmPassword"
                       compare-to="resetPassword.newPassword"
                       ng-keydown="submitOnEnter($event)"
                       required>
                <i class="fa-solid toggle-password"
                   ng-class="showPassword ? 'fa-eye-slash' : 'fa-eye'"
                   ng-click="togglePassword()"></i>
                <span class="error-message"
                      ng-show="resetPasswordForm.confirmPassword.$error.compareTo && resetPasswordForm.confirmPassword.$dirty">
                    Passwords do not match
                </span>
            </div>

            <button type="submit"
                    class="login-button"
                    ng-disabled="resetPasswordForm.$invalid">
                Reset Password
            </button>
        </form>

        <div class="login-links">
            <a href="@Url.Action("LoginPage","Main")" class="link">Back to Login</a>
            <a href="@Url.Action("SignupPage","Main")" class="link">Don't have an account?</a>
        </div>
    </div>
</div>

<footer>
    <div class="footer-container">
        <h2 class="footer-title">Follow our Socials!</h2>
        <div class="social-links">
            <a href="https://www.tiktok.com/&#64;destlounge"
               class="social-item"
               target="_blank">
                <i class="fa-brands fa-tiktok"></i>
                <span>destlounge</span>
            </a>
            <a href="https://www.facebook.com/profile.php?id=61578352581708" class="social-item" target="_blank">
                <i class="fa-brands fa-facebook"></i>
                <span>D'est Lounge</span>
            </a>
            <a href="https://www.instagram.com/destlounge/" class="social-item" target="_blank">
                <i class="fa-brands fa-instagram"></i>
                <span>destlounge</span>
            </a>
        </div>
    </div>
</footer>

<style>
    .alert {
        padding: 15px;
        margin-bottom: 20px;
        border-radius: 4px;
        font-size: 14px;
    }

    .alert-success {
        background-color: #d4edda;
        border: 1px solid #c3e6cb;
        color: #155724;
    }

    .alert-error {
        background-color: #f8d7da;
        border: 1px solid #f5c6cb;
        color: #721c24;
    }

    .forgot-password-text {
        color: #5d4037;
        font-size: 0.95rem;
        margin-bottom: 2rem;
        line-height: 1.5;
        text-align: center;
    }

    .password-group {
        position: relative;
    }

    .toggle-password {
        position: absolute;
        right: 15px;
        top: 50%;
        transform: translateY(-50%);
        cursor: pointer;
        color: #5d4037;
        font-size: 1.1rem;
    }

        .toggle-password:hover {
            color: #3e2723;
        }

    .error-message {
        color: #dc3545;
        font-size: 0.85rem;
        margin-top: 5px;
        display: block;
    }

    .form-input {
        width: 100%;
        padding: 12px 45px 12px 15px;
        border: 1px solid #d7ccc8;
        border-radius: 8px;
        font-size: 1rem;
        transition: border-color 0.3s;
    }

        .form-input:focus {
            outline: none;
            border-color: #8d6e63;
        }

    .login-button {
        width: 100%;
        padding: 14px;
        background-color: #8d6e63;
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: background-color 0.3s;
        margin-top: 1rem;
    }

        .login-button:hover:not(:disabled) {
            background-color: #6d4c41;
        }

        .login-button:disabled {
            background-color: #bcaaa4;
            cursor: not-allowed;
        }

    .login-links {
        display: flex;
        justify-content: space-between;
        margin-top: 1.5rem;
    }

    .link {
        color: #8d6e63;
        text-decoration: none;
        font-size: 0.9rem;
        transition: color 0.3s;
    }

        .link:hover {
            color: #5d4037;
            text-decoration: underline;
        }
</style>
